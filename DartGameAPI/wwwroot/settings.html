<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings - DartsMob</title>
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="stylesheet" href="/css/dartsmob.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Special+Elite&display=swap" rel="stylesheet">
</head>
<body class="settings-page">
    <div id="background-layer" class="background-layer"></div>
    <div id="background-overlay" class="background-overlay"></div>

    <header class="settings-header">
        <a href="/" class="back-link">‚Üê BACK</a>
        <h1 class="settings-title">SETTINGS</h1>
        <div class="header-spacer"></div>
        <!-- Tabs on right -->
        <nav class="settings-nav-inline">
            <button class="nav-tab-sm active" data-tab="calibration">üéØ CALIBRATION</button>
            <button class="nav-tab-sm" data-tab="theme">üé® THEME</button>
            <button class="nav-tab-sm" data-tab="audio">üîä AUDIO</button>
            <button class="nav-tab-sm" data-tab="logs">üìã LOGS</button>
            <button class="nav-tab-sm" data-tab="accuracy">üìä ACCURACY</button>
            <button class="nav-tab-sm" data-tab="system">üñ•Ô∏è SYSTEM</button>
            <button class="nav-tab-sm" data-tab="tuning">üîß TUNING</button>
        </nav>
    </header>

    <main class="settings-container">

        <!-- Calibration Tab -->
        <section id="tab-calibration" class="settings-section active">
            <!-- Section Title -->
            <div class="section-title-row">
                <h2 class="section-title">BOARD CALIBRATION</h2>
                <!-- Camera Selector Buttons - Compact -->
                <div class="camera-selector-compact">
                    <button class="cam-btn-sm active" data-cam="0" id="cam-btn-0">
                        CAM 0 <span class="cam-indicator" id="cam-ind-0">‚óè</span>
                    </button>
                    <button class="cam-btn-sm" data-cam="1" id="cam-btn-1">
                        CAM 1 <span class="cam-indicator" id="cam-ind-1">‚óè</span>
                    </button>
                    <button class="cam-btn-sm" data-cam="2" id="cam-btn-2">
                        CAM 2 <span class="cam-indicator" id="cam-ind-2">‚óè</span>
                    </button>
                </div>
            </div>

            <!-- Large Camera Preview with Canvas Overlay -->
            <div class="camera-preview-full" id="calibration-preview">
                <img id="camera-base-img" class="calibration-camera-img" alt="Camera Feed" style="display:none">
                <canvas id="calibration-canvas" class="calibration-canvas"></canvas>
                <div id="main-camera-loading" class="main-cam-loading">
                    <span>üì∑ Loading camera...</span>
                </div>
                <div id="main-camera-offline" class="main-cam-offline hidden">
                    <span>‚ùå Camera Offline</span>
                </div>
            </div>

            <!-- Camera Actions - Bottom bar -->
            <div class="camera-actions-bar">
                <span id="cam-quality-label" class="cam-quality-label">Not Calibrated</span>
                <span id="cam-focus-label" class="cam-focus-label" style="display:none; margin-left: 10px;"></span>
                <div class="cam-buttons">
                    <button id="refresh-btn" class="btn btn-sm">üîÑ Refresh</button>
                    <button id="focus-btn" class="btn btn-sm">üîç Focus</button>
                    <button id="mark20-btn" class="btn btn-sm">üéØ Mark 20</button>
                    <button id="rotate20-btn" class="btn btn-sm">üîÑ Rotate 20</button>
                    <button id="calibrate-btn" class="btn btn-sm btn-primary">üéØ Calibrate</button>
                </div>
            </div>
        </section>

        <!-- Theme Tab -->
        <section id="tab-theme" class="settings-section">
            <div class="section-header">
                <h2>Customize Appearance</h2>
                <p class="section-desc">Personalize the look and feel of your game</p>
            </div>

            <div class="theme-card">
                <h3>App Branding</h3>
                <div class="input-group">
                    <label for="theme-app-name">App Name</label>
                    <input type="text" id="theme-app-name" class="input" value="DartsMob">
                </div>
                <div class="input-group">
                    <label for="theme-tagline">Tagline</label>
                    <input type="text" id="theme-tagline" class="input" value="The Family's Game">
                </div>
            </div>

            <div class="theme-card">
                <h3>Background Images</h3>
                <p class="hint">Tap to select/deselect backgrounds for slideshow</p>
            </div>

            <div class="theme-card">
                <h3>Overlay Darkness</h3>
                <div class="slider-group">
                    <input type="range" id="overlay-opacity" class="slider" min="0" max="100" value="70">
                    <span id="opacity-value" class="slider-value">70%</span>
                </div>
            </div>

            <div class="action-buttons">
                <button id="reset-theme-btn" class="btn btn-secondary">‚Ü©Ô∏è Reset</button>
                <button id="save-theme-btn" class="btn btn-primary">üíæ Save Theme</button>
            </div>
        </section>

        <!-- Audio Tab -->
        <section id="tab-audio" class="settings-section">
            <div class="section-header">
                <h2>Audio Settings</h2>
                <p class="section-desc">Configure dart score announcements and sound effects</p>
            </div>

            <div class="form-group">
                <label class="form-label">Score Announcements</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="audio-mode" value="off" checked>
                        <span class="radio-label">Off</span>
                        <span class="radio-desc">No audio announcements</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="audio-mode" value="tts">
                        <span class="radio-label">Browser TTS</span>
                        <span class="radio-desc">Uses device's built-in voice (may not work on all devices)</span>
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="audio-mode" value="files">
                        <span class="radio-label">Pre-recorded Audio</span>
                        <span class="radio-desc">High quality MP3 files (recommended for Roku/TV)</span>
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label class="form-label">Volume</label>
                <input type="range" id="audio-volume" min="0" max="100" value="80" class="slider">
                <span id="volume-value" class="slider-value">80%</span>
            </div>

            <div class="form-group">
                <button id="test-audio-btn" class="btn btn-secondary">üîä Test Audio</button>
            </div>

            <div class="audio-files-info" style="margin-top: 20px; padding: 15px; background: rgba(0,0,0,0.3); border-radius: 8px;">
                <h3 style="color: var(--gold); margin-bottom: 10px;">Pre-recorded Audio Setup</h3>
                <p style="color: var(--paper); font-size: 0.9rem; line-height: 1.6;">
                    Place MP3 files in <code style="background: rgba(0,0,0,0.5); padding: 2px 6px; border-radius: 4px;">/wwwroot/audio/</code>
                </p>
                <p style="color: var(--paper-muted); font-size: 0.85rem; margin-top: 10px;">
                    <strong>Required files (64 total):</strong><br>
                    ‚Ä¢ miss.mp3, bust.mp3, bullseye.mp3, double-bullseye.mp3<br>
                    ‚Ä¢ 1.mp3 through 20.mp3 (singles)<br>
                    ‚Ä¢ double-1.mp3 through double-20.mp3<br>
                    ‚Ä¢ triple-1.mp3 through triple-20.mp3
                </p>
            </div>

            <div class="action-row" style="margin-top: 20px;">
                <button id="save-audio-btn" class="btn btn-primary">üíæ Save Audio Settings</button>
            </div>
        </section>

        <!-- Logs Tab -->
        <section id="tab-logs" class="settings-section">
            <div class="section-header">
                <h2>System Logs</h2>
                <p class="section-desc">View and manage application logs</p>
            </div>

            <div class="log-controls" style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; align-items: center;">
                <label style="display: flex; align-items: center; gap: 8px; color: var(--paper);">
                    <input type="checkbox" id="logging-enabled" checked style="width: 18px; height: 18px;">
                    <span>Enable Logging</span>
                </label>
                <select id="log-source-filter" class="form-select" style="width: auto;">
                    <option value="">All Sources</option>
                    <option value="DartDetect">DartDetect</option>
                    <option value="DartSensor">DartSensor</option>
                    <option value="DartGame">DartGame</option>
                    <option value="UI">UI</option>
                </select>
                <select id="log-level-filter" class="form-select" style="width: auto;">
                    <option value="">All Levels</option>
                    <option value="DEBUG">DEBUG</option>
                    <option value="INFO">INFO</option>
                    <option value="WARN">WARN</option>
                    <option value="ERROR">ERROR</option>
                </select>
                <select id="log-limit" class="form-select" style="width: auto;">
                    <option value="50">Last 50</option>
                    <option value="100" selected>Last 100</option>
                    <option value="500">Last 500</option>
                    <option value="1000">Last 1000</option>
                </select>
                <button id="refresh-logs-btn" class="btn btn-secondary">üîÑ Refresh</button>
            </div>

            <div class="log-viewer" style="background: #0a0a0a; border: 1px solid var(--gold-dark); border-radius: 8px; height: 400px; overflow-y: auto; font-family: monospace; font-size: 0.85rem; padding: 10px;">
                <div id="log-content" style="white-space: pre-wrap; color: #ccc;">Loading logs...</div>
            </div>

            <div class="log-stats" style="margin-top: 10px; color: var(--paper-muted); font-size: 0.85rem;">
                <span id="log-count">0 entries</span>
            </div>

            <div class="log-actions" style="margin-top: 15px; display: flex; gap: 10px;">
                <button id="download-logs-btn" class="btn btn-primary">üì• Download Logs</button>
                <button id="clear-logs-btn" class="btn btn-danger" style="background: #8b0000;">üóëÔ∏è Clear All Logs</button>
            </div>
        </section>

        <!-- Accuracy Tab -->
        <section id="tab-accuracy" class="settings-section">
            <div class="section-header">
                <h2>Detection Accuracy</h2>
                <p class="section-desc">Analyze dart detection performance and corrections</p>
            </div>

            <div class="accuracy-controls" style="display: flex; gap: 10px; margin-bottom: 15px; flex-wrap: wrap; align-items: center;">
                <label style="display: flex; align-items: center; gap: 8px; color: var(--paper);">
                    <input type="checkbox" id="benchmark-enabled" style="width: 18px; height: 18px;">
                    <span>Enable Benchmark Logging</span>
                </label>
                <button id="refresh-accuracy-btn" class="btn btn-secondary">üîÑ Refresh</button>
                <button id="rerun-benchmark-btn" class="btn btn-secondary" style="background: #2a5298;">üîÑ Re-run Benchmark</button>
                <button id="auto-tune-btn" class="btn btn-secondary" style="background: #28a745;">üîß Auto-Tune</button>
                <button id="clear-benchmark-btn" class="btn btn-danger" style="background: #8b0000; margin-left: auto;">üóëÔ∏è Clear All Benchmark Data</button>
            </div>

            <div class="accuracy-summary" style="background: #1a1a1a; border: 1px solid var(--gold-dark); border-radius: 8px; padding: 15px; margin-bottom: 15px;">
                <div style="display: flex; gap: 30px; flex-wrap: wrap;">
                    <div class="stat-item">
                        <span style="color: var(--gold); font-size: 2rem; font-weight: bold;" id="overall-accuracy">--</span>
                        <span style="color: var(--paper-muted); display: block;">Overall Accuracy</span>
                    </div>
                    <div class="stat-item">
                        <span style="color: var(--paper); font-size: 2rem; font-weight: bold;" id="total-darts-logged">--</span>
                        <span style="color: var(--paper-muted); display: block;">Darts Logged</span>
                    </div>
                    <div class="stat-item">
                        <span style="color: #ff6b6b; font-size: 2rem; font-weight: bold;" id="total-corrections">--</span>
                        <span style="color: var(--paper-muted); display: block;">Corrections</span>
                    </div>
                </div>
            </div>

            <h3 style="color: var(--gold); margin: 15px 0 10px 0;">Logged Games</h3>
            <div id="games-list" style="max-height: 300px; overflow-y: auto; margin-bottom: 15px;">
                <div class="game-item" style="background: #0a0a0a; border: 1px solid #333; border-radius: 6px; padding: 10px; margin-bottom: 8px; color: var(--paper-muted);">
                    No benchmark data yet. Enable logging and play a game.
                </div>
            </div>

            <!-- Detection Model Selection -->
            <div class="model-selection-section" style="background: #1a1a1a; border: 1px solid var(--gold-dark); border-radius: 8px; padding: 15px; margin-bottom: 15px;">
                <h3 style="color: var(--gold); margin-bottom: 10px;">ü§ñ Detection Model</h3>
                <p style="color: var(--paper-muted); margin-bottom: 15px; font-size: 0.9rem;">
                    Choose which YOLO model to use for dart tip detection. Different models have different speed/accuracy tradeoffs.
                </p>
                
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                    <select id="detection-model-select" style="padding: 10px 15px; background: #0a0a0a; border: 1px solid var(--gold-dark); color: var(--paper); border-radius: 4px; min-width: 250px; font-size: 1rem;">
                        <option value="736x1280">YOLO26n 736x1280 INT8 (Largest)</option>
                        <option value="rect">736x1280 FP16</option>
                        <option value="552x960">YOLO26n 552x960 INT8</option>
                        <option value="square">Square 1088x1088 (Jan 2026)</option>
                        <option value="384x640">YOLO26n 384x640 INT8</option>
                        <option value="best">YOLO26n Pose (Jan 2026)</option>
                        <option value="default">Pose Nano (Dec 2025)</option>
                    </select>
                    <button id="apply-model-btn" class="btn btn-primary" style="padding: 10px 20px;">Apply Model</button>
                    <span id="model-status" style="color: var(--paper-muted);"></span>
                </div>
                
                <div id="model-description" style="color: var(--paper-muted); margin-top: 10px; font-size: 0.85rem; font-style: italic;">
                    Balanced speed/accuracy, INT8 optimized
                </div>
                <!-- Calibration Model Selection -->
                <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid #333;">
                    <h4 style="color: var(--gold); margin: 0 0 10px 0;">Calibration Model</h4>
                    <p style="color: var(--paper-muted); font-size: 0.85rem; margin-bottom: 15px;">
                        Model used for ring detection during calibration. The 11M model may provide better accuracy.
                    </p>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                        <select id="calibration-model-select" style="padding: 10px 15px; background: #0a0a0a; border: 1px solid var(--gold-dark); color: var(--paper); border-radius: 4px; min-width: 250px; font-size: 1rem;">
                            <option value="default">Dartboard 1280 INT8 (Default)</option>
                            <option value="11m">11M Dartboard Model</option>
                        </select>
                        <button id="apply-cal-model-btn" class="btn btn-primary" style="padding: 10px 20px;">Apply</button>
                        <span id="cal-model-status" style="color: var(--paper-muted);"></span>
                    </div>
                </div>
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #333;">
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <label style="color: var(--paper); min-width: 150px;">Confidence Threshold:</label>
                        <input type="range" id="confidence-threshold-slider" 
                               min="0.1" max="0.9" step="0.05" value="0.25"
                               style="flex: 1; min-width: 150px; max-width: 300px;">
                        <span id="confidence-threshold-value" style="color: var(--gold); font-weight: bold; min-width: 50px;">0.25</span>
                        <button id="apply-threshold-btn" class="btn btn-secondary" style="padding: 6px 15px;">Apply</button>
                    </div>
                    <p style="color: var(--paper-muted); font-size: 0.8rem; margin-top: 8px;">
                        Lower = more detections (may include false positives) | Higher = fewer but more reliable detections
                    </p>
                </div>

                <!-- Detection Method Selection -->
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #333;">
                    <h4 style="color: var(--gold); margin: 0 0 10px 0;">üî¨ Detection Method</h4>
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <select id="detection-method-select" style="padding: 10px 15px; background: #0a0a0a; border: 1px solid var(--gold-dark); color: var(--paper); border-radius: 4px; min-width: 250px; font-size: 1rem;">
                            <option value="skeleton">Skeleton Detection (Default, Autodarts-style)</option>
                            <option value="yolo">YOLO Neural Network</option>
                        </select>
                        <button id="apply-method-btn" class="btn btn-primary" style="padding: 10px 20px;">Apply</button>
                        <span id="method-status" style="color: var(--paper-muted);"></span>
                    </div>
                    <div id="method-description" style="color: var(--paper-muted); margin-top: 10px; font-size: 0.85rem;">
                        <strong>Skeleton:</strong> Frame differencing + skeletonization + tip projection (classical CV, like Autodarts). Best accuracy.<br>
                        <strong>YOLO:</strong> Uses trained neural network for dart tip detection.
                    </div>
                </div>

                <!-- Scoring Mode Selection -->
                <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #333;">
                    <h4 style="color: var(--gold); margin: 0 0 10px 0;">üéØ Scoring Mode</h4>
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <select id="scoring-mode-select" style="padding: 10px 15px; background: #0a0a0a; border: 1px solid var(--gold-dark); color: var(--paper); border-radius: 4px; min-width: 250px; font-size: 1rem;">
                            <option value="vote">Ellipse Vote (per-camera consensus)</option>
                            <option value="line_intersection">Line Intersection (experimental)</option>
                        </select>
                        <button id="apply-scoring-btn" class="btn btn-primary" style="padding: 10px 20px;">Apply</button>
                        <span id="scoring-status" style="color: var(--paper-muted);"></span>
                    </div>
                    <div style="color: var(--paper-muted); margin-top: 10px; font-size: 0.85rem;">
                        <strong>Polygon:</strong> Per-camera segment scoring using calibrated polygon boundaries, then weighted vote. Most reliable.<br>
                        <strong>Line Intersection:</strong> Triangulate dart tip position from camera line fits. Experimental ‚Äî requires good line convergence.
                    </div>
                </div>

            </div>



            <!-- Stereo Calibration Section -->
            <div class="stereo-calibration-section" style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #333;">
                <h3 style="color: var(--gold); margin-bottom: 15px;">
                    üî∫ Advanced: 3D Triangulation
                    <span style="font-size: 0.8rem; color: var(--paper-muted); font-weight: normal; margin-left: 10px;">(Optional)</span>
                </h3>
                <p style="color: var(--paper-muted); margin-bottom: 15px;">
                    For higher accuracy, calibrate cameras with a checkerboard pattern to enable true 3D triangulation.
                    This is optional - the default ellipse-based detection works for most cases.
                </p>
                
                <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: center; margin-bottom: 15px;">
                    <span style="color: var(--paper);">Triangulation Mode:</span>
                    <select id="triangulation-mode" style="padding: 8px 15px; background: #1a1a1a; border: 1px solid var(--gold-dark); color: var(--paper); border-radius: 4px;">
                        <option value="ellipse">Ellipse (Default)</option>
                        <option value="stereo">3D Stereo (Requires Calibration)</option>
                    </select>
                    <span id="stereo-status" style="color: var(--paper-muted); margin-left: 10px;">Loading...</span>
                </div>

                <div id="stereo-calibration-panel" style="background: #0a0a0a; border: 1px solid #333; border-radius: 8px; padding: 15px; display: none;">
                    <h4 style="color: var(--paper); margin-bottom: 10px;">Stereo Calibration Steps</h4>
                    
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                        <button id="get-checkerboard-btn" class="btn btn-secondary">üìã Get Checkerboard Pattern</button>
                        <button id="capture-stereo-btn" class="btn btn-secondary">üì∑ Capture Calibration Image</button>
                        <span id="capture-count" style="color: var(--paper-muted); align-self: center;">0 images captured</span>
                    </div>
                    
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                        <button id="run-stereo-calibration-btn" class="btn btn-primary" disabled>üéØ Run Calibration</button>
                        <button id="clear-stereo-captures-btn" class="btn btn-danger" style="background: #8b0000;">üóëÔ∏è Clear Captures</button>
                    </div>
                    
                    <div id="stereo-preview" style="display: none; margin-top: 15px;">
                        <h4 style="color: var(--paper); margin-bottom: 10px;">Preview</h4>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <img id="stereo-preview-cam0" style="max-width: 200px; border: 1px solid #333; border-radius: 4px;">
                            <img id="stereo-preview-cam1" style="max-width: 200px; border: 1px solid #333; border-radius: 4px;">
                            <img id="stereo-preview-cam2" style="max-width: 200px; border: 1px solid #333; border-radius: 4px;">
                        </div>
                    </div>
                    
                    <div id="checkerboard-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 1000;">
                        <div style="max-width: 800px; margin: 50px auto; background: #1a1a1a; border: 1px solid var(--gold); border-radius: 8px; padding: 20px;">
                            <h3 style="color: var(--gold); margin-bottom: 15px;">Checkerboard Pattern</h3>
                            <div style="color: var(--paper-muted); margin-bottom: 15px;">
                                <ol style="padding-left: 20px;">
                                    <li>Print this pattern at 100% scale (no fit-to-page)</li>
                                    <li>Mount on rigid cardboard or foam board</li>
                                    <li>Attach flat to dartboard face</li>
                                    <li>Capture 10+ calibration images at different angles</li>
                                </ol>
                            </div>
                            <img id="checkerboard-image" style="max-width: 100%; border: 1px solid #333;">
                            <div style="margin-top: 15px; display: flex; gap: 10px;">
                                <a id="checkerboard-download" href="#" download="checkerboard.png" class="btn btn-primary">‚¨áÔ∏è Download PNG</a>
                                <button onclick="document.getElementById('checkerboard-modal').style.display='none'" class="btn btn-secondary">Close</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Game Details Modal -->
            <div id="game-details-modal" class="modal hidden" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.97); z-index: 1000; padding: 20px;">
                <div style="display: flex; flex-direction: column; max-width: 900px; max-height: 90vh; margin: auto; width: 100%;">
                    <!-- Fixed header with close button - always visible -->
                    <div style="background: #1a1a1a; border: 2px solid var(--gold); border-bottom: 1px solid #333; border-radius: 12px 12px 0 0; padding: 15px 20px; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0;">
                        <h2 style="color: var(--gold); margin: 0;">Game Details</h2>
                        <button onclick="document.getElementById('game-details-modal').style.display='none'" 
                                style="background: #8b0000; border: none; color: white; font-size: 1rem; cursor: pointer; padding: 8px 16px; border-radius: 4px;">‚úï Close</button>
                    </div>
                    <!-- Scrollable content area -->
                    <div id="game-details-content" style="background: #1a1a1a; border: 2px solid var(--gold); border-top: none; border-radius: 0 0 12px 12px; padding: 20px; overflow-y: auto; flex: 1;">
                        Loading...
                    </div>
                </div>
            </div>
        </section>

        <!-- System Tab -->
        <section id="tab-system" class="settings-section">
            <div class="section-header">
                <h2>System Status</h2>
                <p class="section-desc">Monitor system health and access developer tools</p>
            </div>

            <div class="status-cards vertical">
                <div class="status-card wide">
                    <span class="status-label">DartGame API</span>
                    <span id="sys-game-api" class="status-value status-checking">Checking...</span>
                </div>
                <div class="status-card wide">
                    <span class="status-label">DartDetect API</span>
                    <span id="sys-detect-api" class="status-value status-checking">Checking...</span>
                </div>
                <div class="status-card wide">
                    <span class="status-label">Database</span>
                    <span id="sys-database" class="status-value status-checking">Checking...</span>
                </div>
                <div class="status-card wide">
                    <span class="status-label">SignalR Hub</span>
                    <span id="sys-signalr" class="status-value status-checking">Checking...</span>
                </div>
            </div>
            
            <div class="link-buttons">
                <a href="/architecture.html" class="btn btn-secondary" target="_blank">üìä Architecture</a>
                <a href="/swagger" class="btn btn-secondary" target="_blank">üìö API Docs</a>
            </div>
        </section>
    
        <!-- Benchmark Results Modal -->
        <div id="benchmark-results-modal" class="modal hidden" style="display: none;">
            <div class="modal-content" style="max-width: 900px; max-height: 85vh; overflow-y: auto; background: #1a1a1a;">
                <h2 style="color: var(--gold); margin-bottom: 15px;">üìä Benchmark Replay Results</h2>
                <div id="benchmark-results-content">Running...</div>
                <div style="margin-top: 15px; text-align: right;">
                    <button class="btn btn-secondary" onclick="document.getElementById('benchmark-results-modal').style.display='none'">Close</button>
                </div>
            </div>
        </div>

    
        <!-- Tuning Tab -->
        <section id="tab-tuning" class="settings-section">
            <div class="section-title-row">
                <h2 class="section-title">DETECTION TUNING</h2>
            </div>
            
            <div class="tuning-container">
                <div class="tuning-controls">
                    <div class="tuning-row">
                        <label>Camera:</label>
                        <select id="tuning-camera">
                            <option value="cam0">Camera 0</option>
                            <option value="cam1">Camera 1</option>
                            <option value="cam2">Camera 2</option>
                        </select>
                    </div>
                    <div class="tuning-row">
                        <label>Threshold: <span id="threshold-value">25</span></label>
                        <input type="range" id="threshold-slider" min="5" max="80" value="25" step="5">
                    </div>
                    <div class="tuning-row">
                        <button class="btn-primary" id="capture-baseline">üì∑ Capture Baseline</button>
                        <button class="btn-secondary" id="refresh-tuning">üîÑ Refresh</button>
                        <button class="btn-secondary" id="auto-refresh-toggle">‚ñ∂Ô∏è Auto</button>
                        <label class="tuning-checkbox">
                            <input type="checkbox" id="show-pipeline"> Show Pipeline
                        </label>
                    </div>
                    <div class="tuning-info">
                        <p id="mask-pixel-count">Mask pixels: --</p>
                        <p class="tuning-help">
                            1. Clear the board<br>
                            2. Click "Capture Baseline"<br>
                            3. Throw a dart<br>
                            4. Click "Refresh" to see detection<br>
                            5. Adjust threshold until only dart shows red
                        </p>
                    </div>
                </div>
                <div class="tuning-preview">
                    <img id="tuning-image" src="" alt="Click Capture Baseline to start">
                    <p id="tuning-status">Clear the board and click Capture Baseline</p>
                </div>
            </div>
        </section>

        </main>

    <script src="/js/settings.js"></script>
</body>
</html>
